<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#335599"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-cyclinbox.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-cyclinbox.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-cyclinbox.png">
  <link rel="mask-icon" href="/images/apple-touch-icon-cyclinbox.png" color="#335599">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"wz.anoms.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#37c0c6","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="太长不看：python优先使用系统硬件随机噪声（urandom）作为随机数种子，如果无法获得urandom则使用系统时间；随机数序列使用梅森旋转算法（Mersenne Twister）实现，以生成足够随机的数字。">
<meta property="og:type" content="article">
<meta property="og:title" content="python标准库中的随机数种子选取策略">
<meta property="og:url" content="https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/index.html">
<meta property="og:site_name" content="Warren&#39;s Blog">
<meta property="og:description" content="太长不看：python优先使用系统硬件随机噪声（urandom）作为随机数种子，如果无法获得urandom则使用系统时间；随机数序列使用梅森旋转算法（Mersenne Twister）实现，以生成足够随机的数字。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-12T07:00:00.000Z">
<meta property="article:modified_time" content="2025-07-13T16:01:39.372Z">
<meta property="article:author" content="Warren Z">
<meta property="article:tag" content="计算机技术杂谈">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="random">
<meta property="article:tag" content="C">
<meta property="article:tag" content="梅森旋转算法">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/","path":"2025/07/12/python-random-lib-seed-implementation/","title":"python标准库中的随机数种子选取策略"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>python标准库中的随机数种子选取策略 | Warren's Blog</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?b9a00db803ec11a8bedcc6012afff1b3"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Warren's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/%E5%8F%8B%E9%93%BE/" rel="section"><i class="fa fa-user-group fa-fw"></i>友链</a></li><li class="menu-item menu-item-about"><a href="/%E5%85%B3%E4%BA%8E/" rel="section"><i class="fa fa-circle-info fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%B5%B7%E5%9B%A0"><span class="nav-number">1.</span> <span class="nav-text">一、起因</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E4%B8%80%E4%BA%9B%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86"><span class="nav-number">2.</span> <span class="nav-text">二、一些需要知道的背景知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E7%A1%AC%E4%BB%B6%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%86%B5%E6%B1%A0%EF%BC%88%E6%88%96urandom%EF%BC%89"><span class="nav-number">2.1.</span> <span class="nav-text">（一）硬件随机数熵池（或urandom）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95%EF%BC%88Mersenne-Twister%EF%BC%89"><span class="nav-number">2.2.</span> <span class="nav-text">（二）梅森旋转算法（Mersenne Twister）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81python%E6%A0%87%E5%87%86%E5%BA%93%E4%B8%ADrandom-seed-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.</span> <span class="nav-text">三、python标准库中random.seed()的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E6%8F%8F%E8%BF%B0"><span class="nav-number">3.1.</span> <span class="nav-text">（一）文档中的描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E8%A1%A8%E9%9D%A2%E4%B8%8A%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81Lib-random-py"><span class="nav-number">3.2.</span> <span class="nav-text">（二）表面上的源代码Lib&#x2F;random.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E7%9C%9F%E6%AD%A3%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81-Modules-randommodule-c"><span class="nav-number">3.3.</span> <span class="nav-text">（三）真正的源代码 Modules&#x2F;_randommodule.c</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Warren Z"
      src="/images/cyclinbox.png">
  <p class="site-author-name" itemprop="name">Warren Z</p>
  <div class="site-description" itemprop="description">小楼一夜听春雨，深巷明朝卖杏花</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">249</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">457</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/cyclinbox" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;cyclinbox" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhangwanyu2000@outlook.com" title="E-Mail → mailto:zhangwanyu2000@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/" title="回主页 → &#x2F;"><i class="fa fa-home fa-fw"></i>回主页</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/cyclinbox" class="github-corner" title="My GitHub" aria-label="My GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/cyclinbox.png">
      <meta itemprop="name" content="Warren Z">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Warren's Blog">
      <meta itemprop="description" content="小楼一夜听春雨，深巷明朝卖杏花">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="python标准库中的随机数种子选取策略 | Warren's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          python标准库中的随机数种子选取策略
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-07-12 15:00:00" itemprop="dateCreated datePublished" datetime="2025-07-12T15:00:00+08:00">2025-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-14 00:01:39" itemprop="dateModified" datetime="2025-07-14T00:01:39+08:00">2025-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">计算机</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>太长不看：python优先使用系统硬件随机噪声（urandom）作为随机数种子，如果无法获得urandom则使用系统时间；随机数序列使用梅森旋转算法（Mersenne Twister）实现，以生成足够随机的数字。</p>
<span id="more"></span>

<hr>
<h2 id="一、起因"><a href="#一、起因" class="headerlink" title="一、起因"></a>一、起因</h2><p>某天在修改一个python编写的模块时，遇到了一个问题。该模块使用python标准库  <code>random</code> 生成随机序列，每次调用时都会使用 <code>random.seed()</code> 通过默认参数创建一个实例化对象。我怀疑这里通过默认参数得到的随机数不够随机，因此对python标准库中的随机数底层实现进行了探究。</p>
<h2 id="二、一些需要知道的背景知识"><a href="#二、一些需要知道的背景知识" class="headerlink" title="二、一些需要知道的背景知识"></a>二、一些需要知道的背景知识</h2><h3 id="（一）硬件随机数熵池（或urandom）"><a href="#（一）硬件随机数熵池（或urandom）" class="headerlink" title="（一）硬件随机数熵池（或urandom）"></a>（一）硬件随机数熵池（或urandom）</h3><blockquote>
<p>参考 ： <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/427489847">/dev/random 和 /dev/urandom 的原理 - 程序员十三的文章 - 知乎</a></p>
</blockquote>
<p>python中相关的接口是 <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/os.html#os.urandom"><code>os.urandom</code></a> 。其调用的底层函数在Linux系统上是<code>/dev/urandom</code> ，在windows系统上是<code>BCryptGenRandom()</code> 。</p>
<p><code>/dev/random</code> 和 <code>/dev/urandom</code> 是 Linux 上的字符设备文件，它们是 <strong>随机数生成器</strong> ，为系统提供随机数；在Windows上，它使用的是<code>CryptGenRandom</code>或<code>BCryptGenRandom</code>（取决于Windows版本）。</p>
<p>随机数生成器会收集系统环境中各种数据，比如：鼠标的移动，键盘的输入, 终端的连接以及断开，音视频的播放，系统中断，内存 CPU 的使用等等；生成器把收集到的各种环境数据放入一个池子 (  <strong>熵池</strong> ) 中，然后将这些数据进行去偏、漂白，主要目的也是使得数据更加无序，更加难以猜测或者预料得到。</p>
<p>有了大量的环境数据之后，每次获取随机数时，从池子中读取指定的字节序列，这些字节序列就是生成器生成的随机数。</p>
<p>urandom或者说熵池，存储的是真随机数。</p>
<h3 id="（二）梅森旋转算法（Mersenne-Twister）"><a href="#（二）梅森旋转算法（Mersenne-Twister）" class="headerlink" title="（二）梅森旋转算法（Mersenne Twister）"></a>（二）梅森旋转算法（Mersenne Twister）</h3><blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32892000">谈谈梅森旋转：算法及其爆破 - 孟晨的文章 - 知乎</a> 以及 <a target="_blank" rel="noopener" href="https://hasegawaazusa.github.io/mersenne-twister-note.html">Mersenne Twister 梅森旋转算法笔记 </a> 。更通俗易懂的解释见博客 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/CHNmuxii/p/12232475.html">你没听过的梅森旋转算法</a> 。以下是对算法的简单介绍，而不是详细的原理分析。</p>
</blockquote>
<p>这是一种由松本眞（Makoto Matsumoto）和西村拓士（Takuji Nishimura）在 1997 年提出的伪随机数生成算法。这个旋转算法实际上是对一个19937级的二进制序列作变换。在数学上我们可以证明一个定理，即对于一个长度为n的二进制序列，它的排列长度最长为 $2^n$  （实际上可能因为某些操作不当，没挺到 $2^n$ 个就开始循环了）。那么如何将这个序列的排列撑满 $2^n$ 个，就是这个旋转算法的精髓。</p>
<p>以下是梅森旋转算法的步骤：</p>
<ol>
<li>利用 seed 初始化寄存器状态</li>
<li>对寄存器状态进行旋转</li>
<li>根据寄存器状态提取伪随机数</li>
</ol>
<p>绝大多数标准库当中内置的随机数发生器，就是对梅森旋转算法的实现。而要生成不同的随机数序列，关键问题就在于seed（随机数种子）的选择。</p>
<p>好了，终于到了我们关心的环节：随机数种子的选择原理。</p>
<h2 id="三、python标准库中random-seed-的实现"><a href="#三、python标准库中random-seed-的实现" class="headerlink" title="三、python标准库中random.seed()的实现"></a>三、python标准库中<code>random.seed()</code>的实现</h2><h3 id="（一）文档中的描述"><a href="#（一）文档中的描述" class="headerlink" title="（一）文档中的描述"></a>（一）文档中的描述</h3><p>为了搞清楚原理，我去查阅了官方文档和源代码。</p>
<p>下面是<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/random.html#random.seed">官方文档</a>中的描述，其中提到seed()函数接受一个参数a作为随机数种子，但是用户不提供a也是可以的，python会选取一个默认值作为随机数种子。根据这里的描述，默认（a=None时），<strong>优先</strong>使用操作系统的随机熵源（如Linux的<code>/dev/urandom</code>），若不可用，则回退到使用系统时间。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">random.seed(a=None, version=2)</span><br><span class="line"></span><br><span class="line">	Initialize the random number generator.</span><br><span class="line">	</span><br><span class="line">	If a is omitted or None, the current system time is used. If randomness sources are provided by the operating system, they are used instead of the system time (see the os.urandom() function for details on availability).</span><br><span class="line">	</span><br><span class="line">	If a is an int, it is used directly.</span><br></pre></td></tr></table></figure>

<h3 id="（二）表面上的源代码Lib-random-py"><a href="#（二）表面上的源代码Lib-random-py" class="headerlink" title="（二）表面上的源代码Lib/random.py"></a>（二）表面上的源代码<code>Lib/random.py</code></h3><p>但其实这里的解释有些模糊，于是我去查询了源代码。首先查到的是 <a target="_blank" rel="noopener" href="https://github.com/python/cpython/blob/3.13/Lib/random.py"><code>Lib/random.py</code></a> （但实际上这个并非真正的源代码）。<a target="_blank" rel="noopener" href="https://github.com/python/cpython/blob/3.13/Lib/random.py"><code>Lib/random.py</code></a> 的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">seed</span>(<span class="params">self, a=<span class="literal">None</span>, version=<span class="number">2</span></span>):</span><br><span class="line">	<span class="keyword">if</span> version == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">str</span>, <span class="built_in">bytes</span>)):</span><br><span class="line">		a = a.decode(<span class="string">&#x27;latin-1&#x27;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(a, <span class="built_in">bytes</span>) <span class="keyword">else</span> a</span><br><span class="line">		x = <span class="built_in">ord</span>(a[<span class="number">0</span>]) &lt;&lt; <span class="number">7</span> <span class="keyword">if</span> a <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">map</span>(<span class="built_in">ord</span>, a):</span><br><span class="line">			x = ((<span class="number">1000003</span> * x) ^ c) &amp; <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line">		x ^= <span class="built_in">len</span>(a)</span><br><span class="line">		a = -<span class="number">2</span> <span class="keyword">if</span> x == -<span class="number">1</span> <span class="keyword">else</span> x</span><br><span class="line"></span><br><span class="line">	<span class="keyword">elif</span> version == <span class="number">2</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">str</span>, <span class="built_in">bytes</span>, <span class="built_in">bytearray</span>)):</span><br><span class="line">		<span class="keyword">global</span> _sha512</span><br><span class="line">		<span class="keyword">if</span> _sha512 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				<span class="comment"># hashlib is pretty heavy to load, try lean internal</span></span><br><span class="line">				<span class="comment"># module first</span></span><br><span class="line">				<span class="keyword">from</span> _sha2 <span class="keyword">import</span> sha512 <span class="keyword">as</span> _sha512</span><br><span class="line">			<span class="keyword">except</span> ImportError:</span><br><span class="line">				<span class="comment"># fallback to official implementation</span></span><br><span class="line">				<span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512 <span class="keyword">as</span> _sha512</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">isinstance</span>(a, <span class="built_in">str</span>):</span><br><span class="line">			a = a.encode()</span><br><span class="line">		a = <span class="built_in">int</span>.from_bytes(a + _sha512(a).digest())</span><br><span class="line"></span><br><span class="line">	<span class="keyword">elif</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">type</span>(<span class="literal">None</span>), <span class="built_in">int</span>, <span class="built_in">float</span>, <span class="built_in">str</span>, <span class="built_in">bytes</span>, <span class="built_in">bytearray</span>)):</span><br><span class="line">		<span class="keyword">raise</span> TypeError(<span class="string">&#x27;The only supported seed types are:\n&#x27;</span></span><br><span class="line">						<span class="string">&#x27;None, int, float, str, bytes, and bytearray.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">super</span>().seed(a)</span><br><span class="line">	self.gauss_next = <span class="literal">None</span></span><br></pre></td></tr></table></figure>


<p>请注意，此处源代码中似乎只有将用户参数a转换为int类型的操作，并没有涉及到对当前时间的调用或对urandom的调用（甚至也没有实现梅森旋转算法）。seed函数的最后，调用了 <code>super().seed(a)</code> 这个函数接口，我也同样没有找到这个函数的定义。</p>
<p>有些沮丧，于是我去求助了chatGPT和Gemini。在它们的帮助之下，我找到了真正的源代码，并解决了最初的那个问题。</p>
<h3 id="（三）真正的源代码-Modules-randommodule-c"><a href="#（三）真正的源代码-Modules-randommodule-c" class="headerlink" title="（三）真正的源代码 Modules/_randommodule.c"></a>（三）真正的源代码 <code>Modules/_randommodule.c</code></h3><p>AI告诉我，前面查到的代码是<code>random.Random.seed</code> 函数的实现，而最后的 <code>super().seed(a)</code> 调用的是父类的<code>seed()</code>方法。解决问题的关键就在这个父类上。</p>
<p><strong><code>Random</code> 类的继承关系是这样的：</strong></p>
<ul>
<li><code>random.Random</code>（Python实现）</li>
<li><code>random._random.Random</code>（C语言实现，作为Python的内置模块）</li>
</ul>
<p>大多数情况下，Python会用 C 实现的 <code>_random.Random</code>，而这个C语言实现的源码位置在<a target="_blank" rel="noopener" href="https://github.com/python/cpython/blob/3.13/Modules/_randommodule.c"><code>Modules/_randommodule.c</code></a>  。</p>
<p>于是我去寻找了这个源代码，其内容如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span></span><br><span class="line"><span class="title function_">random_seed</span><span class="params">(RandomObject *self, PyObject *arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">-1</span>;  <span class="comment">/* guilty until proved innocent */</span></span><br><span class="line">    PyObject *n = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">uint32_t</span> *key = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> bits, keyused;</span><br><span class="line">    <span class="type">int</span> res;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (arg == <span class="literal">NULL</span> || arg == Py_None) &#123;</span><br><span class="line">       <span class="keyword">if</span> (random_seed_urandom(self) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            PyErr_Clear();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* Reading system entropy failed, fall back on the worst entropy:</span></span><br><span class="line"><span class="comment">               use the current time and process identifier. */</span></span><br><span class="line">            <span class="keyword">if</span> (random_seed_time_pid(self) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* This algorithm relies on the number being unsigned.</span></span><br><span class="line"><span class="comment">     * So: if the arg is a PyLong, use its absolute value.</span></span><br><span class="line"><span class="comment">     * Otherwise use its hash value, cast to unsigned.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span> (PyLong_CheckExact(arg)) &#123;</span><br><span class="line">        n = PyNumber_Absolute(arg);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (PyLong_Check(arg)) &#123;</span><br><span class="line">        <span class="comment">/* Calling int.__abs__() prevents calling arg.__abs__(), which might</span></span><br><span class="line"><span class="comment">           return an invalid value. See issue #31478. */</span></span><br><span class="line">        _randomstate *state = _randomstate_type(Py_TYPE(self));</span><br><span class="line">        n = PyObject_CallOneArg(state-&gt;Long___abs__, arg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Py_hash_t hash = PyObject_Hash(arg);</span><br><span class="line">        <span class="keyword">if</span> (hash == <span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">goto</span> Done;</span><br><span class="line">        n = PyLong_FromSize_t((<span class="type">size_t</span>)hash);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">goto</span> Done;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Now split n into 32-bit chunks, from the right. */</span></span><br><span class="line">    bits = _PyLong_NumBits(n);</span><br><span class="line">    <span class="keyword">if</span> (bits == (<span class="type">size_t</span>)<span class="number">-1</span> &amp;&amp; PyErr_Occurred())</span><br><span class="line">        <span class="keyword">goto</span> Done;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Figure out how many 32-bit chunks this gives us. */</span></span><br><span class="line">    keyused = bits == <span class="number">0</span> ? <span class="number">1</span> : (bits - <span class="number">1</span>) / <span class="number">32</span> + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Convert seed to byte sequence. */</span></span><br><span class="line">    key = (<span class="type">uint32_t</span> *)PyMem_Malloc((<span class="type">size_t</span>)<span class="number">4</span> * keyused);</span><br><span class="line">    <span class="keyword">if</span> (key == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        PyErr_NoMemory();</span><br><span class="line">        <span class="keyword">goto</span> Done;</span><br><span class="line">    &#125;</span><br><span class="line">    res = _PyLong_AsByteArray((PyLongObject *)n,</span><br><span class="line">                              (<span class="type">unsigned</span> <span class="type">char</span> *)key, keyused * <span class="number">4</span>,</span><br><span class="line">                              PY_LITTLE_ENDIAN,</span><br><span class="line">                              <span class="number">0</span>, <span class="comment">/* unsigned */</span></span><br><span class="line">                              <span class="number">1</span>); <span class="comment">/* with exceptions */</span></span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">goto</span> Done;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PY_BIG_ENDIAN</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">size_t</span> i, j;</span><br><span class="line">        <span class="comment">/* Reverse an array. */</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>, j = keyused - <span class="number">1</span>; i &lt; j; i++, j--) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> tmp = key[i];</span><br><span class="line">            key[i] = key[j];</span><br><span class="line">            key[j] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    init_by_array(self, key, keyused);</span><br><span class="line"></span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Done:</span><br><span class="line">    Py_XDECREF(n);</span><br><span class="line">    PyMem_Free(key);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>其中即涉及到seed默认值的选取，又涉及到梅森旋转算法的实现。我们要关注的是前者，对应的代码片段如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (arg == NULL || arg == Py_None) &#123;</span><br><span class="line">   <span class="keyword">if</span> (random_seed_urandom(self) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		PyErr_Clear();</span><br><span class="line"></span><br><span class="line">		/* Reading system entropy failed, fall back on the worst entropy:</span><br><span class="line">		   use the current time <span class="keyword">and</span> process identifier. */</span><br><span class="line">		<span class="keyword">if</span> (random_seed_time_pid(self) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码的意思是这样：</p>
<ul>
<li>程序首先尝试调用 <code>random_seed_urandom(self)</code>。这个函数内部会尝试从 <code>os.urandom()</code>读取足够多的（通常是32字节）高质量随机字节来初始化Mersenne Twister（梅森旋转算法）的状态。</li>
<li>如果 <code>os.urandom()</code> 不可用或读取失败（<code>&lt; 0</code>），程序会清除这个错误，然后fall back到 <code>random_seed_time_pid(self)</code> ，即获取当前的高精度时间戳和当前进程的ID（Process ID），将它们混合起来作为种子。这是一种质量较低但兼容性很强的后备方案。</li>
</ul>
<p><strong>因此，我们的最终结论是：默认种子的选择策略是 <code>os.urandom</code> 优先，失败则回退到 <code>时间 + 进程ID</code>。</strong></p>

    </div>

    
    
    
      


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Warren Z
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/" title="python标准库中的随机数种子选取策略">https://wz.anoms.top/2025/07/12/python-random-lib-seed-implementation/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/" rel="tag"><i class="fa fa-tag"></i> 计算机技术杂谈</a>
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
              <a href="/tags/random/" rel="tag"><i class="fa fa-tag"></i> random</a>
              <a href="/tags/C/" rel="tag"><i class="fa fa-tag"></i> C</a>
              <a href="/tags/%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95/" rel="tag"><i class="fa fa-tag"></i> 梅森旋转算法</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/07/06/YOLO11_demo_deploy/" rel="prev" title="YOLO11图像识别模型初次上手">
                  <i class="fa fa-chevron-left"></i> YOLO11图像识别模型初次上手
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/07/13/20250713_updatelog/" rel="next" title="一些有趣的社会观察（基于两篇文章）">
                  一些有趣的社会观察（基于两篇文章） <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  
  <div class="comments giscus-container">
  </div>
  
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">津ICP备20004656号 </a>
  </div>

<div class="copyright">
  &copy; 2020 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Warren Z</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"cyclinbox/cyclinbox.github.io","repo_id":"MDEwOlJlcG9zaXRvcnk0MDQ5ODMzNzY=","category":"General","category_id":"DIC_kwDOGCOOUM4CWZSA","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"preferred-color-scheme","lang":"zh-CN","input_position":"top"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

<!-- hexo injector body_end start -->
    <link rel="stylesheet" crossorigin href="https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.24/index.css" />
    <script type="module" crossorigin src="https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.24/index.js"></script>
    <script>
      window.CHATBOT_CONFIG = {
        //endpoint: "/chat", // 可以替换为 https://{your-fc-http-trigger-domain}/chat
        endpoint: "https://webchat-bot-pbz-ojggjrcplw.cn-hangzhou.fcapp.run/chat",  
        displayByDefault: false, // 默认不显示 AI 助手对话框
        title: 'Warren的桌宠', // 自定义 AI 助手标题
        draggable: true, // 是否开启拖拽
        aiChatOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#conversation-options
          conversationOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#conversation-options
            conversationStarters: [
              {prompt: '介绍一下Warren blog？'},
              {prompt: '博主对人生和社会的思考有哪些？'},
              {prompt: '在这个博客中，有哪些实用的计算机技术?'},
            ]
          },
          displayOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#display-options
            height: 600,
            // width: 400,
          },
          personaOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#chat-personas
            assistant: {
              name: 'Warren blog对话助手（powered by 通义千问）',
              // AI 助手的图标
              avatar: 'https://pic1.imgdb.cn/item/67b1ca92d0e0a243d4ffd69b.jpg',
		//https://img.alicdn.com/imgextra/i2/O1CN01Pda9nq1YDV0mnZ31H_!!6000000003025-54-tps-120-120.apng',
              tagline: '您可以尝试点击下方的快捷入口开启体验！',
            }
          },
          messageOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#message-options
            waitTimeBeforeStreamCompletion: 'never'
          }
        },
        dataProcessor: {
          /**
          * 在向后端大模型应用发起请求前改写 Prompt。
          * 比如可以用于总结网页场景，在发送前将网页内容包含在内，同时避免在前端显示这些内容。
          * @param {string} prompt - 用户输入的 Prompt
          * @param {string}  - 改写后的 Prompt
          */
          rewritePrompt(prompt) {
            return prompt;
          }
        }
      };
    </script>
    <style>
      :root {
        /* webchat 工具栏的颜色 */
        --webchat-toolbar-background-color: #1464E4;
        /* webchat 工具栏文字和按钮的颜色 */
        --webchat-toolbar-text-color: #FFF;
      }
      /* webchat 对话框如果被遮挡，可以尝试通过 z-index、bottom、right 等设置 来调整*/
      .webchat-container {
        z-index: 100;
        bottom: 10px;
        right: 10px;
      }
      /* webchat 的唤起按钮如果被遮挡，可以尝试通过 z-index、bottom、right 等设置 来调整。也可以通过 CSS 进一步定制唤起按钮的形状、大小等。 */
      .webchat-bubble-tip {
        z-index: 99;
        bottom: 20px;
        right: 20px;
      }
    </style> 
<!-- hexo injector body_end end --></body>
</html>
